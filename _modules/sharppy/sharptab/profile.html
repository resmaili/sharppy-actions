<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sharppy.sharptab.profile &mdash; SHARPpy  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> SHARPpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../picker.html">Running SHARPpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interpreting_gui.html">Interpreting the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../insets.html">Interpreting the Insets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interacting_gui.html">Interacting with the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasource_guide.html">Custom Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html">Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">SHARPpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../citing.html">Citing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SHARPpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>sharppy.sharptab.profile</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sharppy.sharptab.profile</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39; Create the Sounding (Profile) Object &#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="k">as</span> <span class="nn">ma</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">sharppy.sharptab</span> <span class="kn">import</span> <span class="n">utils</span><span class="p">,</span> <span class="n">winds</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">interp</span><span class="p">,</span> <span class="n">thermo</span><span class="p">,</span> <span class="n">watch_type</span><span class="p">,</span> <span class="n">fire</span>
<span class="kn">import</span> <span class="nn">sharppy.io.qc_tools</span> <span class="k">as</span> <span class="nn">qc_tools</span>
<span class="kn">from</span> <span class="nn">sharppy.databases.sars</span> <span class="kn">import</span> <span class="n">hail</span><span class="p">,</span> <span class="n">supercell</span>
<span class="kn">from</span> <span class="nn">sharppy.databases.pwv</span> <span class="kn">import</span> <span class="n">pwv_climo</span>
<span class="kn">from</span> <span class="nn">sharppy.sharptab.constants</span> <span class="kn">import</span> <span class="n">MISSING</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<div class="viewcode-block" id="create_profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.create_profile">[docs]</a><span class="k">def</span> <span class="nf">create_profile</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This is a wrapper function for constructing Profile objects</span>
<span class="sd">    and objects that inherit from the Profile class. This will</span>
<span class="sd">    construct and return the appropriate Profile object</span>
<span class="sd">    based on the supplied keyword argument. If no profile keyword</span>
<span class="sd">    is supplied, it defaults to a basic Profile. This also requires</span>
<span class="sd">    that you pass through all the relevant keyword arguments for</span>
<span class="sd">    the constructors to the Profile objects and the objects that</span>
<span class="sd">    inherit from Profile.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Mandatory Keywords</span>

<span class="sd">    pres : array_like</span>
<span class="sd">        The pressure values (Hectopascals)</span>
<span class="sd">    hght : array_like</span>
<span class="sd">        The corresponding height values (Meters)</span>
<span class="sd">    tmpc : array_like</span>
<span class="sd">        The corresponding temperature values (Celsius)</span>
<span class="sd">    dwpc : array_like</span>
<span class="sd">        The corresponding dewpoint temperature values (Celsius)</span>

<span class="sd">    Optional Keyword Pairs (must use one or the other)</span>

<span class="sd">    wdir : array_like</span>
<span class="sd">        The direction from which the wind is blowing in meteorological degrees</span>
<span class="sd">    wspd : array_like</span>
<span class="sd">        The speed of the wind (kts)</span>

<span class="sd">    OR</span>

<span class="sd">    u : array_like</span>
<span class="sd">        The U-component of the direction from which the wind is blowing. (kts)</span>

<span class="sd">    v : array_like</span>
<span class="sd">        The V-component of the direction from which the wind is blowing. (kts)</span>

<span class="sd">    Optional Keywords</span>

<span class="sd">    missing : number, optional (default: sharppy.sharptab.constants.MISSING)</span>
<span class="sd">        The value of the missing flag used in the Profile objects</span>

<span class="sd">    profile : string, optional (default: &#39;default&#39;)</span>
<span class="sd">        The text identifier for the Profile to be generated. Valid options</span>
<span class="sd">        include (&#39;default&#39; | &#39;basic&#39; | &#39;convective&#39;). Default will construct a basic</span>
<span class="sd">        Profile, and convective will construct a ConvectiveProfile used for</span>
<span class="sd">        the SPC style GUI. </span>

<span class="sd">    omeg: array_like</span>
<span class="sd">        The corresponding vertical velocity values (Pa/s)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Profile : a basic Profile object</span>
<span class="sd">        This is the most basic and default object.</span>

<span class="sd">    OR</span>

<span class="sd">    ConvectiveProfile : a child of Profile</span>
<span class="sd">        This is the class used for the SPC GUI.</span>


<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">## Get the user&#39;s input for which Profile to construct.</span>
    <span class="c1">## Make the default the &#39;default&#39; profile.</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="c1">## if the profile is default, pass the rest of the keyword</span>
    <span class="c1">## arguments to the BasicProfile object and return it</span>
    <span class="k">if</span> <span class="n">profile</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">BasicProfile</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1">## if the profile is raw, return a base profile object</span>
    <span class="k">elif</span> <span class="n">profile</span> <span class="o">==</span> <span class="s1">&#39;raw&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Profile</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1">## if the profile is convective, pass the rest of the keyword</span>
    <span class="c1">## arguments to the ConvectiveProfile object and return it</span>
    <span class="k">elif</span> <span class="n">profile</span> <span class="o">==</span> <span class="s1">&#39;convective&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ConvectiveProfile</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.Profile">[docs]</a><span class="k">class</span> <span class="nc">Profile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">## set the missing variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">missing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strictQC</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strictQC&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1">## get the data and turn them into arrays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pres</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hght</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hght&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tmpc&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dwpc&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hght</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
               <span class="s2">&quot;The dimensions of the pres, hght, tmpc, and dwpc arrays passed to the Profile object constructor are not all one dimensional.&quot;</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hght</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span>\
               <span class="s2">&quot;The length of the pres, hght, tmpc, and dwpc arrays passed to Profile object constructor must all have a length greater than 1.&quot;</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hght</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">),</span>\
                <span class="s2">&quot;The pres, hght, tmpc, or dwpc arrays passed to the Profile object constructor must all have the same length.&quot;</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The pressure values passed to the profile object are below 100 mb.  This may cause some the SHARPpy routines not to behave as expected.&quot;</span><span class="p">)</span> 

        <span class="k">if</span> <span class="s1">&#39;wdir&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;wspd&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wdir&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wspd&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">),</span> <span class="s2">&quot;The wdir and wspd arrays passed to the Profile constructor must have the same length as the pres array.&quot;</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;The wdir and wspd arrays passed to the Profile constructor are not one dimensional.&quot;</span>
            <span class="c1">#self.u, self.v = utils.vec2comp(self.wdir, self.wspd)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">## did the user provide the wind in u,v form?</span>
        <span class="k">elif</span> <span class="s1">&#39;u&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;v&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">),</span> <span class="s2">&quot;The u and v arrays passed to the Profile constructor must have the same length as the pres array.&quot;</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;The wdir and wspd arrays passed to the Profile constructor are not one dimensional.&quot;</span>
            <span class="c1">#self.wdir, self.wspd = utils.comp2vec(self.u, self.v)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No wind data (wdir/wspd or u/v) passed to the Profile object constructor.  This may cause some of the SHARPpy routines to not behave as expected.&quot;</span><span class="p">)</span>

        <span class="c1">## check if any standard deviation data was supplied</span>
        <span class="k">if</span> <span class="s1">&#39;tmp_stdev&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dew_stdev</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dew_stdev&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_stdev</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tmp_stdev&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dew_stdev</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_stdev</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;omeg&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">## get the omega data and turn into arrays</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omeg</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;omeg&#39;</span><span class="p">))</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omeg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">),</span> <span class="s2">&quot;Length of omeg array passed to constructor is not the same length as the pres array.&quot;</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">omeg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;omeg array is not one dimensional.&quot;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omeg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;omeg array length must have a length greater than 1.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omeg</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">## optional keyword argument for location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strictQC</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkDataIntegrity</span><span class="p">()</span>

<div class="viewcode-block" id="Profile.copy"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.Profile.copy">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prof</span><span class="p">,</span> <span class="n">strictQC</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Copies a profile object.</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prof</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;pres&#39;</span><span class="p">,</span> <span class="s1">&#39;hght&#39;</span><span class="p">,</span> <span class="s1">&#39;tmpc&#39;</span><span class="p">,</span> <span class="s1">&#39;dwpc&#39;</span><span class="p">,</span> <span class="s1">&#39;omeg&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;strictQC&#39;</span><span class="p">,</span> <span class="s1">&#39;missing&#39;</span> <span class="p">])</span>

        <span class="k">if</span> <span class="n">prof</span><span class="o">.</span><span class="n">u</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">prof</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;u&#39;</span><span class="p">:</span><span class="n">prof</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span><span class="n">prof</span><span class="o">.</span><span class="n">v</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;wspd&#39;</span><span class="p">:</span><span class="n">prof</span><span class="o">.</span><span class="n">wspd</span><span class="p">,</span> <span class="s1">&#39;wdir&#39;</span><span class="p">:</span><span class="n">prof</span><span class="o">.</span><span class="n">wdir</span><span class="p">})</span>
        
        <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;strictQC&#39;</span><span class="p">:</span><span class="n">strictQC</span><span class="p">})</span>

        <span class="c1"># Create a new profile object using the old profile object data cls is the Class type (e.g., ConvectiveProfile)</span>
        <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">new_prof</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">new_kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">prof</span><span class="p">,</span> <span class="s1">&#39;srwind&#39;</span><span class="p">):</span>
            <span class="n">rmu</span><span class="p">,</span> <span class="n">rmv</span><span class="p">,</span> <span class="n">lmu</span><span class="p">,</span> <span class="n">lmv</span> <span class="o">=</span> <span class="n">prof</span><span class="o">.</span><span class="n">srwind</span>
            <span class="n">new_prof</span><span class="o">.</span><span class="n">set_srright</span><span class="p">(</span><span class="n">rmu</span><span class="p">,</span> <span class="n">rmv</span><span class="p">)</span>
            <span class="n">new_prof</span><span class="o">.</span><span class="n">set_srleft</span><span class="p">(</span><span class="n">lmu</span><span class="p">,</span> <span class="n">lmv</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_prof</span></div>

<div class="viewcode-block" id="Profile.toFile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.Profile.toFile">[docs]</a>    <span class="k">def</span> <span class="nf">toFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="n">snd_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">qc</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">9999.</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">QC</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">else</span> <span class="n">val</span>

        <span class="n">snd_loc</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span>

        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="c1">#print(now, self.date)</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;%TITLE%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">   </span><span class="si">%s</span><span class="se">\n</span><span class="s2"> Saved by user: </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2"> UTC</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">snd_loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">/%H%M&quot;</span><span class="p">),</span> <span class="n">user</span><span class="p">,</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">/%H%M&#39;</span><span class="p">)))</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;   LEVEL       HGHT       TEMP       DWPT       WDIR       WSPD</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;%RAW%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span> <span class="s1">&#39;hght&#39;</span><span class="p">,</span> <span class="s1">&#39;tmpc&#39;</span><span class="p">,</span> <span class="s1">&#39;dwpc&#39;</span><span class="p">,</span> <span class="s1">&#39;wdir&#39;</span><span class="p">,</span> <span class="s1">&#39;wspd&#39;</span><span class="p">]:</span>
                <span class="nb">str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%8.2f</span><span class="s2">,  &quot;</span> <span class="o">%</span> <span class="n">qc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>

            <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2">ND%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">snd_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Profile.checkDataIntegrity"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.Profile.checkDataIntegrity">[docs]</a>    <span class="k">def</span> <span class="nf">checkDataIntegrity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">isHGHTValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hght</span><span class="p">):</span>
            <span class="n">qc_tools</span><span class="o">.</span><span class="n">raiseError</span><span class="p">(</span><span class="s2">&quot;Invalid height data.  Data has repeat height values or height does not increase as pressure decreases.&quot;</span><span class="p">,</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">DataQualityException</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">isTMPCValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">):</span>
            <span class="n">qc_tools</span><span class="o">.</span><span class="n">raiseError</span><span class="p">(</span><span class="s2">&quot;Invalid temperature data. Profile contains a temperature value &lt; -273.15 Celsius.&quot;</span><span class="p">,</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">DataQualityException</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">isDWPCValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">):</span>
            <span class="n">qc_tools</span><span class="o">.</span><span class="n">raiseError</span><span class="p">(</span><span class="s2">&quot;Invalid dewpoint data. Profile contains a dewpoint value &lt; -273.15 Celsius.&quot;</span><span class="p">,</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">DataQualityException</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">isWSPDValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="p">):</span>
            <span class="n">qc_tools</span><span class="o">.</span><span class="n">raiseError</span><span class="p">(</span><span class="s2">&quot;Invalid wind speed data. Profile contains a wind speed value &lt; 0 knots.&quot;</span><span class="p">,</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">DataQualityException</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">isWDIRValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">):</span>
            <span class="n">qc_tools</span><span class="o">.</span><span class="n">raiseError</span><span class="p">(</span><span class="s2">&quot;Invalid wind direction data. Profile contains a wind direction &lt; 0 degrees or &gt;= 360 degrees.&quot;</span><span class="p">,</span> <span class="n">qc_tools</span><span class="o">.</span><span class="n">DataQualityException</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BasicProfile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile">[docs]</a><span class="k">class</span> <span class="nc">BasicProfile</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The default data class for SHARPpy. </span>
<span class="sd">    All other data classes inherit from this class.</span>
<span class="sd">    This class holds the vertical data for pressure,</span>
<span class="sd">    height, temperature, dewpoint, and winds. This class</span>
<span class="sd">    has no indices computed.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create the sounding data object</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Mandatory Keywords</span>
<span class="sd">        pres : array_like</span>
<span class="sd">            The pressure values (Hectopaschals)</span>
<span class="sd">        hght : array_like</span>
<span class="sd">            The corresponding height values (Meters)</span>
<span class="sd">        tmpc : array_like</span>
<span class="sd">            The corresponding temperature values (Celsius)</span>
<span class="sd">        dwpc : array_like</span>
<span class="sd">        The corresponding dewpoint temperature values (Celsius)</span>
<span class="sd">            </span>
<span class="sd">        Optional Keyword Pairs (must use one or the other)</span>
<span class="sd">        wdir : array_like</span>
<span class="sd">            The direction from which the wind is blowing in</span>
<span class="sd">            meteorological degrees</span>
<span class="sd">        wspd : array_like</span>
<span class="sd">            The speed of the wind (kts)</span>
<span class="sd">            </span>
<span class="sd">        OR</span>
<span class="sd">            </span>
<span class="sd">        u : array_like</span>
<span class="sd">            The U-component of the direction from which the wind</span>
<span class="sd">            is blowing (kts)</span>
<span class="sd">            </span>
<span class="sd">        v : array_like</span>
<span class="sd">            The V-component of the direction from which the wind</span>
<span class="sd">            is blowing. (kts)</span>
<span class="sd">            </span>
<span class="sd">        Optional Keywords</span>
<span class="sd">        missing : number (default: sharppy.sharptab.constants.MISSING)</span>
<span class="sd">            The value of the missing flag</span>

<span class="sd">        location : string (default: None)</span>
<span class="sd">            The 3 character station identifier or 4 character</span>
<span class="sd">            WMO station ID for radiosonde locations. Used for</span>
<span class="sd">            the PWV database.</span>
<span class="sd">        </span>
<span class="sd">        strictQC : boolean</span>
<span class="sd">            A flag that indicates whether or not the strict quality control</span>
<span class="sd">            routines should be run on the profile upon construction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        prof: Profile object</span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BasicProfile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">strictQC</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strictQC&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1">## did the user provide the wind in vector form?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wdir</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wspd</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">vec2comp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span><span class="p">)</span>

        <span class="c1">## did the user provide the wind in u,v form?</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wspd</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>

        <span class="c1">## check if any standard deviation data was supplied</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp_stdev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dew_stdev</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dew_stdev</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_stdev</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp_stdev</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dew_stdev</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_stdev</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">omeg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">## get the omega data and turn into arrays</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omeg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">omeg</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omeg</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hght</span><span class="p">))</span>

        <span class="c1"># QC Checks on the arrays passed to the constructor.</span>
        <span class="n">qc_tools</span><span class="o">.</span><span class="n">areProfileArrayLengthEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
       
        <span class="c1">## mask the missing values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hght</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hght</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtmp</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">virtemp</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span> <span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtmp</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="c1"># Masking any virtual temperature </span>

        <span class="c1">## get the index of the top and bottom of the profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sfc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_top</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strictQC</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkDataIntegrity</span><span class="p">()</span>

        <span class="c1">## generate the wetbulb profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wetbulb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wetbulb_profile</span><span class="p">()</span>
        <span class="c1">## generate theta-e profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thetae</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thetae_profile</span><span class="p">()</span>
        <span class="c1">## generate theta profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_theta_profile</span><span class="p">()</span>
        <span class="c1">## generate water vapor mixing ratio profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wvmr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wvmr_profile</span><span class="p">()</span>
        <span class="c1">## generate rh profile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rh_profile</span><span class="p">()</span>

<div class="viewcode-block" id="BasicProfile.get_sfc"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_sfc">[docs]</a>    <span class="k">def</span> <span class="nf">get_sfc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Convenience function to get the index of the surface. It is</span>
<span class="sd">            determined by finding the lowest level in which a temperature is</span>
<span class="sd">            reported.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            None</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            Index of the surface</span>
<span class="sd">            </span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="o">.</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="BasicProfile.get_top"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_top">[docs]</a>    <span class="k">def</span> <span class="nf">get_top</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Convenience function to get the index of the surface. It is</span>
<span class="sd">            determined by finding the lowest level in which a temperature is</span>
<span class="sd">            reported.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            None</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            Index of the surface</span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="o">.</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span></div>
     
<div class="viewcode-block" id="BasicProfile.get_wvmr_profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_wvmr_profile">[docs]</a>    <span class="k">def</span> <span class="nf">get_wvmr_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Function to calculate the water vapor mixing ratio profile.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            None</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            Array of water vapor mixing ratio profile</span>
<span class="sd">            &#39;&#39;&#39;</span>
        
        <span class="c1">#wvmr = ma.empty(self.pres.shape[0])</span>
        <span class="c1">#for i in range(len(self.v)):</span>
        <span class="n">wvmr</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">mixratio</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span> <span class="p">)</span>
        <span class="n">wvmr</span><span class="p">[</span><span class="n">wvmr</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">wvmr</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wvmr</span></div>
    
<div class="viewcode-block" id="BasicProfile.get_wetbulb_profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_wetbulb_profile">[docs]</a>    <span class="k">def</span> <span class="nf">get_wetbulb_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Function to calculate the wetbulb profile.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            None</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            Array of wet bulb profile</span>
<span class="sd">            &#39;&#39;&#39;</span>
        
        <span class="n">wetbulb</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">wetbulb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">wetbulb</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">wetbulb</span><span class="p">[</span><span class="n">wetbulb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">wetbulb</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wetbulb</span></div>
    
<div class="viewcode-block" id="BasicProfile.get_theta_profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_theta_profile">[docs]</a>    <span class="k">def</span> <span class="nf">get_theta_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Function to calculate the theta profile.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            None</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            Array of theta profile</span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">theta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">theta</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">theta</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ctok</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">theta</span></div>
    
<div class="viewcode-block" id="BasicProfile.get_thetae_profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_thetae_profile">[docs]</a>    <span class="k">def</span> <span class="nf">get_thetae_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Function to calculate the theta-e profile.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            None</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            Array of theta-e profile</span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="n">thetae</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">thetae</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ctok</span><span class="p">(</span> <span class="n">thermo</span><span class="o">.</span><span class="n">thetae</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">thetae</span><span class="p">[</span><span class="n">thetae</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">thetae</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">thetae</span></div>

<div class="viewcode-block" id="BasicProfile.get_rh_profile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.BasicProfile.get_rh_profile">[docs]</a>    <span class="k">def</span> <span class="nf">get_rh_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to calculate the relative humidity profile</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">    </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of the relative humidity profile</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">rh</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">relh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">)</span>
        <span class="n">rh</span><span class="p">[</span><span class="n">rh</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">]</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">rh</span><span class="o">.</span><span class="n">set_fill_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">missing</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rh</span></div></div>


<div class="viewcode-block" id="ConvectiveProfile"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile">[docs]</a><span class="k">class</span> <span class="nc">ConvectiveProfile</span><span class="p">(</span><span class="n">BasicProfile</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The Convective data class for SHARPPy. This is the class used</span>
<span class="sd">    to generate the indices that are default for the SPC NSHARP display.</span>
<span class="sd">    </span>
<span class="sd">    This class inherits from the Profile object.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create the sounding data object</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Mandatory Keywords</span>
<span class="sd">        pres : array_like</span>
<span class="sd">            The pressure values (Hectopaschals)</span>
<span class="sd">        hght : array_like</span>
<span class="sd">            The corresponding height values (Meters)</span>
<span class="sd">        tmpc : array_like</span>
<span class="sd">            The corresponding temperature values (Celsius)</span>
<span class="sd">        dwpc : array_like</span>
<span class="sd">            The corresponding dewpoint temperature values (Celsius)</span>
<span class="sd">            </span>
<span class="sd">        Optional Keyword Pairs (must use one or the other)</span>
<span class="sd">        wdir : array_like</span>
<span class="sd">            The direction from which the wind is blowing in</span>
<span class="sd">            meteorological degrees</span>
<span class="sd">        wspd : array_like</span>
<span class="sd">            The speed of the wind (kts)</span>
<span class="sd">        </span>
<span class="sd">        OR</span>
<span class="sd">            </span>
<span class="sd">        u : array_like</span>
<span class="sd">            The U-component of the direction from which the wind</span>
<span class="sd">            is blowing</span>
<span class="sd">            </span>
<span class="sd">        v : array_like</span>
<span class="sd">            The V-component of the direction from which the wind</span>
<span class="sd">            is blowing.</span>
<span class="sd">            </span>
<span class="sd">        missing : number, optional (default: sharppy.sharptab.constants.MISSING)</span>
<span class="sd">            The value of the missing flag</span>

<span class="sd">        location : string, optional (default: None)</span>
<span class="sd">            The 3 character station identifier or 4 character</span>
<span class="sd">            WMO station ID for radiosonde locations. Used for</span>
<span class="sd">            the PWV database.</span>

<span class="sd">        omeg : array_like, optional</span>
<span class="sd">            List of the vertical velocity in pressure coordinates with height (Pascals/second)</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A profile object</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">## call the constructor for Profile</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ConvectiveProfile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;ConvectiveProfile objects require that the minimum pressure passed in the data array is greater than 100 mb.&quot;</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Generate the fire weather paramters</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_fire().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_fire</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_fire() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1"># Generate the winter inset/precipitation types</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_precip().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_precip</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_precip() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## generate various parcels</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_parcels().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_parcels</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_parcels() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## calculate thermodynamic window indices</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_thermo().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_thermo</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_thermo() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## generate wind indices</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_kinematics().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_kinematics</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_kinematics() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## get SCP, STP(cin), STP(fixed), SHIP</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_severe().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_severe</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_severe() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## calculate the SARS database matches</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_sars().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_sars</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_sars() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## get the precipitable water climatology</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_PWV_loc().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_PWV_loc</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_PWV_loc() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## get the parcel trajectory</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_traj().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_traj() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## miscellaneous indices I didn&#39;t know where to put</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_indices().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_indices</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_indices() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

        <span class="c1">## get the possible watch type</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling get_watch().&quot;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_watch</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;get_watch() took: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">dt</span><span class="p">)))</span>

<div class="viewcode-block" id="ConvectiveProfile.get_fire"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_fire">[docs]</a>    <span class="k">def</span> <span class="nf">get_fire</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate different indices and information</span>
<span class="sd">        regarding any fire weather in the sounding.  This helps fill</span>
<span class="sd">        the data shown in the FIRE inset.</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fosberg</span> <span class="o">=</span> <span class="n">fire</span><span class="o">.</span><span class="n">fosberg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">haines_hght</span> <span class="o">=</span> <span class="n">fire</span><span class="o">.</span><span class="n">haines_height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">haines_low</span> <span class="o">=</span> <span class="n">fire</span><span class="o">.</span><span class="n">haines_low</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">haines_mid</span> <span class="o">=</span> <span class="n">fire</span><span class="o">.</span><span class="n">haines_mid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">haines_high</span> <span class="o">=</span> <span class="n">fire</span><span class="o">.</span><span class="n">haines_high</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppbl_top</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">pbl_top</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc_rh</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">relh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dwpc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">])</span>
        <span class="n">pres_sfc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">]</span>
        <span class="n">pres_1km</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pbl_h</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_agl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">hght</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppbl_top</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rh01km</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_relh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">pres_sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">pres_1km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pblrh</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_relh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">pres_sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ppbl_top</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meanwind01km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">pres_sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">pres_1km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meanwindpbl</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">pres_sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ppbl_top</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pblmaxwind</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">max_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pbl_h</span><span class="p">)</span>
        <span class="c1">#self.pblmaxwind = [np.ma.masked, np.ma.masked]</span>
        <span class="n">mulplvals</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">DefineParcel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="n">mupcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">cape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lplvals</span><span class="o">=</span><span class="n">mulplvals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bplus_fire</span> <span class="o">=</span> <span class="n">mupcl</span><span class="o">.</span><span class="n">bplus</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_precip"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_precip">[docs]</a>    <span class="k">def</span> <span class="nf">get_precip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate different indices and information</span>
<span class="sd">        regarding any precipitation in the sounding.  This helps fill</span>
<span class="sd">        the data shown in the WINTER inset.</span>

<span class="sd">        Returns nothing, but sets the following</span>
<span class="sd">        variables:</span>

<span class="sd">        self.dgz_pbot, self.dgz_ptop : the dendretic growth zone (DGZ) top and bottom (mb)</span>
<span class="sd">        self.dgz_meanrh : DGZ mean relative humidity (%)</span>
<span class="sd">        self.dgz_pw : the preciptable water vapor in the DGZ (inches)</span>
<span class="sd">        self.dgz_meanq : the mean water vapor mixing ratio in the DGZ (g/kg)</span>
<span class="sd">        self.dgz_meanomeg : the mean omega in the DGZ (microbars/second)</span>
<span class="sd">        self.oprh : the OPRH variable (units don&#39;t mean anything)</span>
<span class="sd">        self.plevel, self.phase, self.tmp, self.st : the initial phase, level, temperature, and state of any precip in the sounding</span>
<span class="sd">        self.tpos, self.tneg, self.ttop, self.tbot : positive and negative temperature layers in the sounding</span>
<span class="sd">        self.wpos, self.wneg, self.wtop, self.wbot : positive and negative wetbulb layers in the soundings</span>
<span class="sd">        self.precip_type : the best guess precipitation type</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgz_pbot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgz_ptop</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">dgz</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgz_meanrh</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_relh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_pbot</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_ptop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgz_pw</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">precip_water</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_pbot</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_ptop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgz_meanq</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_mixratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_pbot</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_ptop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgz_meanomeg</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_omega</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_pbot</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_ptop</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="c1"># to microbars/sec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oprh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgz_meanomeg</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgz_pw</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgz_meanrh</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plevel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">st</span> <span class="o">=</span> <span class="n">watch_type</span><span class="o">.</span><span class="n">init_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tneg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbot</span> <span class="o">=</span> <span class="n">watch_type</span><span class="o">.</span><span class="n">posneg_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plevel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wneg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wtop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wbot</span> <span class="o">=</span> <span class="n">watch_type</span><span class="o">.</span><span class="n">posneg_wetbulb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plevel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precip_type</span> <span class="o">=</span> <span class="n">watch_type</span><span class="o">.</span><span class="n">best_guess_precip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plevel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tneg</span><span class="p">)</span></div>


<div class="viewcode-block" id="ConvectiveProfile.get_parcels"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_parcels">[docs]</a>    <span class="k">def</span> <span class="nf">get_parcels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate various parcels and parcel</span>
<span class="sd">        traces.</span>
<span class="sd">        Returns nothing, but sets the following</span>
<span class="sd">        variables:</span>

<span class="sd">        self.mupcl : Most Unstable Parcel</span>
<span class="sd">        self.sfcpcl : Surface Based Parcel</span>
<span class="sd">        self.mlpcl : Mixed Layer Parcel</span>
<span class="sd">        self.fcstpcl : Forecast Surface Parcel</span>
<span class="sd">        self.ebottom : The bottom pressure level of the effective inflow layer</span>
<span class="sd">        self.etop : the top pressure level of the effective inflow layer</span>
<span class="sd">        self.ebotm : The bottom, meters (agl), of the effective inflow layer</span>
<span class="sd">        self.etopm : The top, meters (agl), of the effective inflow layer</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parcelx</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">3</span> <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">lplvals</span><span class="o">.</span><span class="n">pres</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parcelx</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcstpcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parcelx</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parcelx</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usrpcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">Parcel</span><span class="p">()</span>

        <span class="c1">## get the effective inflow layer data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">effective_inflow_layer</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">mupcl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span> <span class="p">)</span>

        <span class="c1">## if there was no effective inflow layer, set the values to masked</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span> <span class="ow">is</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span> <span class="ow">is</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">etopm</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">effpcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span> <span class="c1"># Default to surface parcel, as in params.DefineProfile().</span>

        <span class="c1">## otherwise, interpolate the heights given to above ground level</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_agl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">hght</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">etopm</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_agl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">hght</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">))</span>
            <span class="c1"># The below code was adapted from params.DefineProfile()</span>
            <span class="c1"># Lifting one additional parcel probably won&#39;t slow the program too much.</span>
            <span class="c1"># It&#39;s just one more lift compared to all the lifts in the params.effective_inflow_layer() call.</span>
            <span class="n">mtha</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_theta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">)</span>
            <span class="n">mmr</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_mixratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">)</span>
            <span class="n">effpres</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">efftmpc</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">theta</span><span class="p">(</span><span class="mf">1000.</span><span class="p">,</span> <span class="n">mtha</span><span class="p">,</span> <span class="n">effpres</span><span class="p">)</span>
            <span class="n">effdwpc</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">temp_at_mixrat</span><span class="p">(</span><span class="n">mmr</span><span class="p">,</span> <span class="n">effpres</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">effpcl</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parcelx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="n">effpres</span><span class="p">,</span> <span class="n">tmpc</span><span class="o">=</span><span class="n">efftmpc</span><span class="p">,</span> <span class="n">dwpc</span><span class="o">=</span><span class="n">effdwpc</span><span class="p">)</span> <span class="c1">#This is the effective parcel.</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_kinematics"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_kinematics">[docs]</a>    <span class="k">def</span> <span class="nf">get_kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate the numerous kinematic quantities</span>
<span class="sd">        used for display and calculations. It requires that the</span>
<span class="sd">        parcel calculations have already been called for the lcl</span>
<span class="sd">        to el shear and mean wind vectors, as well as indices</span>
<span class="sd">        that require an effective inflow layer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">sfc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">]</span>
        <span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1000.</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">,</span> <span class="mf">5000.</span><span class="p">,</span> <span class="mf">6000.</span><span class="p">,</span> <span class="mf">8000.</span><span class="p">,</span> <span class="mf">9000.</span><span class="p">])</span>
        <span class="n">p1km</span><span class="p">,</span> <span class="n">p3km</span><span class="p">,</span> <span class="n">p4km</span><span class="p">,</span> <span class="n">p5km</span><span class="p">,</span> <span class="n">p6km</span><span class="p">,</span> <span class="n">p8km</span><span class="p">,</span> <span class="n">p9km</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heights</span><span class="p">))</span>
        <span class="c1">## 1km and 6km winds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wind1km</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wind6km</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p6km</span><span class="p">)</span>
        <span class="c1">## calcluate wind shear</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc_1km_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p1km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc_3km_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p3km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc_6km_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p6km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc_8km_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p8km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfc_9km_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p9km</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcl_el_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">lclpres</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">elpres</span><span class="p">)</span>
        <span class="c1">## calculate mean wind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_1km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p1km</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_3km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p3km</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_6km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p6km</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_8km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p8km</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_lcl_el</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">lclpres</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">elpres</span><span class="p">))</span>
        <span class="c1">## parameters that depend on the presence of an effective inflow layer</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span> <span class="ow">is</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span> <span class="ow">is</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">etopm</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bunkers</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">non_parcel_bunkers_motion</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bunkers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">srwind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eff_shear</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebwd</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebwspd</span> <span class="o">=</span> <span class="n">MISSING</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_eff</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_ebw</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_eff</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_ebw</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_esrh</span> <span class="o">=</span> <span class="p">[</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_critical_angle</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_eff</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_ebw</span> <span class="o">=</span> <span class="p">[</span><span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">,</span> <span class="n">MISSING</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_esrh</span> <span class="o">=</span> <span class="p">[</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">,</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_critical_angle</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bunkers</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">bunkers_storm_motion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mupcl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bunkers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">srwind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span>
            <span class="n">depth</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">elhght</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">elh</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span> <span class="o">+</span> <span class="n">depth</span><span class="p">))</span>
            <span class="c1">## calculate mean wind</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_eff</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_ebw</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">mean_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">elh</span> <span class="p">)</span>
            <span class="c1">## calculate wind shear of the effective layer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eff_shear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebwd</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">wind_shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">elh</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebwspd</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">mag</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebwd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebwd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
            <span class="c1">## calculate quantities relative to the right-mover vector</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_eff</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_ebw</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">elh</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_esrh</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">helicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etopm</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_critical_angle</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">critical_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1">## calculate quantities relative to the left-mover vector</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_eff</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">etop</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_ebw</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">elh</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_esrh</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">helicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebotm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etopm</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_critical_angle</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">critical_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1">## calculate quantities relative to the right-mover vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_1km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p1km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_3km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p3km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_6km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p6km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_8km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p8km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_4_5km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">p4km</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p5km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_lcl_el</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">lclpres</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">elpres</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">))</span>
        <span class="c1"># This is for the red, blue, and purple bars that appear on the SR Winds vs. Height plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_0_2km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">2000.</span><span class="p">)),</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_4_6km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">)),</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p6km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_9_11km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">9000.</span><span class="p">)),</span> <span class="n">ptop</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">11000.</span><span class="p">)),</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1">## calculate quantities relative to the left-mover vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_1km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p1km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_3km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p3km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_6km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p6km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_8km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p8km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_4_5km</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">p4km</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p5km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_lcl_el</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">comp2vec</span><span class="p">(</span><span class="o">*</span><span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">lclpres</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">elpres</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">))</span>
        <span class="c1"># This is for the red, blue, and purple bars that appear on the SR Winds vs. Height plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_0_2km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">sfc</span><span class="p">,</span> <span class="n">ptop</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">2000.</span><span class="p">)),</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_4_6km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">4000.</span><span class="p">)),</span> <span class="n">ptop</span><span class="o">=</span><span class="n">p6km</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srw_9_11km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">sr_wind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">9000.</span><span class="p">)),</span> <span class="n">ptop</span><span class="o">=</span><span class="n">interp</span><span class="o">.</span><span class="n">pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interp</span><span class="o">.</span><span class="n">to_msl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">11000.</span><span class="p">)),</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        
        <span class="c1">## calculate upshear and downshear</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upshear_downshear</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">mbe_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srh1km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">helicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_srh3km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">helicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srh1km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">helicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_srh3km</span> <span class="o">=</span> <span class="n">winds</span><span class="o">.</span><span class="n">helicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">,</span> <span class="n">stu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">stv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">srwind</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">srw_eff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_eff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_ebw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_ebw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">esrh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_esrh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_critical_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_1km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_1km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_3km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_3km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_6km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_6km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_8km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_8km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_4_5km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_4_5km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_lcl_el</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_lcl_el</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_0_2km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_0_2km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_4_6km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_4_6km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srw_9_11km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srw_9_11km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srh1km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srh1km</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srh3km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srh3km</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_thermo"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_thermo">[docs]</a>    <span class="k">def</span> <span class="nf">get_thermo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate thermodynamic indices.</span>
<span class="sd">        </span>
<span class="sd">        Function returns nothing, but sets the following</span>
<span class="sd">        variables:</span>

<span class="sd">        self.k_idx - K Index, a severe weather index</span>
<span class="sd">        self.pwat - Precipitable Water Vapor (inches)</span>
<span class="sd">        self.lapserate_3km - 0 to 3km AGL lapse rate (C/km)</span>
<span class="sd">        self.lapserate_3_6km - 3 to 6km AGL lapse rate (C/km)</span>
<span class="sd">        self.lapserate_850_500 - 850 to 500mb lapse rate (C/km)</span>
<span class="sd">        self.lapserate_700_500 - 700 to 500mb lapse rate (C/km)</span>
<span class="sd">        self.convT - The Convective Temperature (F)</span>
<span class="sd">        self.maxT - The Maximum Forecast Surface Temp (F)</span>
<span class="sd">        self.mean_mixr - Mean Mixing Ratio</span>
<span class="sd">        self.low_rh - low level mean relative humidity</span>
<span class="sd">        self.mid_rh - mid level mean relative humidity</span>
<span class="sd">        self.totals_totals - Totals Totals index, a severe weather index</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">## either get or calculate the indices, round to the nearest int, and</span>
        <span class="c1">## convert them to strings.</span>
        <span class="c1">## K Index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_idx</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">k_index</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="c1">## precipitable water</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwat</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">precip_water</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="c1">## 0-3km agl lapse rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lapserate_3km</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">lapse_rate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
        <span class="c1">## 3-6km agl lapse rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lapserate_3_6km</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">lapse_rate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mf">3000.</span><span class="p">,</span> <span class="mf">6000.</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
        <span class="c1">## 850-500mb lapse rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lapserate_850_500</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">lapse_rate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mf">850.</span><span class="p">,</span> <span class="mf">500.</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
        <span class="c1">## 700-500mb lapse rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lapserate_700_500</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">lapse_rate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mf">700.</span><span class="p">,</span> <span class="mf">500.</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
        <span class="c1">## 2-6 km max lapse rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_lapse_rate_2_6</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">max_lapse_rate</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="c1">## convective temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convT</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ctof</span><span class="p">(</span> <span class="n">params</span><span class="o">.</span><span class="n">convective_temp</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c1">## sounding forecast surface temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxT</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ctof</span><span class="p">(</span> <span class="n">params</span><span class="o">.</span><span class="n">max_temp</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c1">#fzl = str(int(self.sfcparcel.hght0c))</span>
        <span class="c1">## 100mb mean mixing ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_mixr</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_mixratio</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="c1">## 150mb mean rh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_rh</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_relh</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_rh</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean_relh</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pbot</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">]</span> <span class="o">-</span> <span class="mi">150</span><span class="p">),</span>
            <span class="n">ptop</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc</span><span class="p">]</span> <span class="o">-</span> <span class="mi">350</span><span class="p">)</span> <span class="p">)</span>
        <span class="c1">## calculate the totals totals index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totals_totals</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">t_totals</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="c1">## calculate the inferred temperature advection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inf_temp_adv</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">inferred_temp_adv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_severe"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_severe">[docs]</a>    <span class="k">def</span> <span class="nf">get_severe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to calculate special severe weather indices.</span>
<span class="sd">        Requires calling get_parcels() and get_kinematics().</span>

<span class="sd">        Returns nothing, but sets the following variables:</span>

<span class="sd">        self.right_stp_fixed - fixed layer significant tornado parameter (computed with SRH relative to the right-mover vector)</span>
<span class="sd">        self.left_stp_fixed - fixed layer significant tornado parameter (computed with SRH relative to the left-mover vector)</span>
<span class="sd">        self.right_stp_cin - effective layer significant tornado parameter (computed with SRH relative to the right-mover vector)</span>
<span class="sd">        self.left_stp_cin - effective layer significant tornado parameter (computed with SRH relative to the left-mover vector)</span>
<span class="sd">        self.right_scp - right moving supercell composite parameter</span>
<span class="sd">        self.left_scp - left moving supercell composite parameter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">wspd</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">mag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfc_6km_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_6km_shear</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_stp_fixed</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">stp_fixed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span><span class="o">.</span><span class="n">bplus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span><span class="o">.</span><span class="n">lclhght</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srh1km</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span><span class="n">wspd</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_stp_fixed</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">stp_fixed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span><span class="o">.</span><span class="n">bplus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfcpcl</span><span class="o">.</span><span class="n">lclhght</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_srh1km</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span><span class="n">wspd</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sherbe</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sherb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">effective</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">etop</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebottom</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_scp</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_scp</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_stp_cin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_stp_cin</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_scp</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">scp</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">bplus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_esrh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ebwspd</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_scp</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">scp</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">bplus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_esrh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ebwspd</span><span class="p">))</span>

            <span class="n">right_esrh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_esrh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">left_esrh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_esrh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">right_esrh</span> <span class="o">=</span> <span class="o">-</span><span class="n">right_esrh</span>
                <span class="n">left_esrh</span> <span class="o">=</span> <span class="o">-</span><span class="n">left_esrh</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">right_stp_cin</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">stp_cin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">bplus</span><span class="p">,</span> <span class="n">right_esrh</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ebwspd</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">lclhght</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">bminus</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_stp_cin</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">stp_cin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">bplus</span><span class="p">,</span> <span class="n">left_esrh</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ebwspd</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">lclhght</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">bminus</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">right_stp_cin</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">right_stp_cin</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">left_stp_cin</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">left_stp_cin</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stp_fixed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_stp_fixed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stp_cin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_stp_cin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_scp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stp_fixed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_stp_fixed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stp_cin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_stp_cin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_scp</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_sars"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_sars">[docs]</a>    <span class="k">def</span> <span class="nf">get_sars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to get the SARS analogues from the hail and</span>
<span class="sd">        supercell databases. Requires calling get_kinematics()</span>
<span class="sd">        and get_parcels() first. Also calculates the significant</span>
<span class="sd">        hail parameter.</span>
<span class="sd">        </span>
<span class="sd">        Function returns nothing, but sets the following variables:</span>

<span class="sd">        self.matches - the matches from SARS HAIL</span>
<span class="sd">        self.ship - significant hail parameter</span>
<span class="sd">        self.supercell_matches - the matches from SARS SUPERCELL</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">sfc_6km_shear</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span> <span class="n">utils</span><span class="o">.</span><span class="n">mag</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_6km_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_6km_shear</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">sfc_3km_shear</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span> <span class="n">utils</span><span class="o">.</span><span class="n">mag</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_3km_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_3km_shear</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">sfc_9km_shear</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">KTS2MS</span><span class="p">(</span> <span class="n">utils</span><span class="o">.</span><span class="n">mag</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_9km_shear</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfc_9km_shear</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">h500t</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">temp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">500.</span><span class="p">)</span>
        <span class="n">lapse_rate</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">lapse_rate</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="mf">700.</span><span class="p">,</span> <span class="mf">500.</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
        <span class="n">right_srh3km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srh3km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">right_srh1km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_srh1km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">left_srh3km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_srh3km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">left_srh1km</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_srh1km</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mucape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">bplus</span>
        <span class="n">mlcape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">bplus</span>
        <span class="n">mllcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlpcl</span><span class="o">.</span><span class="n">lclhght</span>
        <span class="n">mumr</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">mixratio</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">pres</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span><span class="o">.</span><span class="n">dwpc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ship</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">ship</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hail_database</span> <span class="o">=</span> <span class="s1">&#39;sars_hail.txt&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">supercell_database</span> <span class="o">=</span> <span class="s1">&#39;sars_supercell.txt&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_matches</span> <span class="o">=</span> <span class="n">hail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hail_database</span><span class="p">,</span> <span class="n">mumr</span><span class="p">,</span> <span class="n">mucape</span><span class="p">,</span> <span class="n">h500t</span><span class="p">,</span> <span class="n">lapse_rate</span><span class="p">,</span> <span class="n">sfc_6km_shear</span><span class="p">,</span>
                <span class="n">sfc_9km_shear</span><span class="p">,</span> <span class="n">sfc_3km_shear</span><span class="p">,</span> <span class="n">right_srh3km</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_matches</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_matches</span> <span class="o">=</span> <span class="n">hail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hail_database</span><span class="p">,</span> <span class="n">mumr</span><span class="p">,</span> <span class="n">mucape</span><span class="p">,</span> <span class="n">h500t</span><span class="p">,</span> <span class="n">lapse_rate</span><span class="p">,</span> <span class="n">sfc_6km_shear</span><span class="p">,</span>
                <span class="n">sfc_9km_shear</span><span class="p">,</span> <span class="n">sfc_3km_shear</span><span class="p">,</span> <span class="o">-</span><span class="n">left_srh3km</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_matches</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_supercell_matches</span> <span class="o">=</span> <span class="n">supercell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">supercell_database</span><span class="p">,</span> <span class="n">mlcape</span><span class="p">,</span> <span class="n">mllcl</span><span class="p">,</span> <span class="n">h500t</span><span class="p">,</span> <span class="n">lapse_rate</span><span class="p">,</span> 
                <span class="n">utils</span><span class="o">.</span><span class="n">MS2KTS</span><span class="p">(</span><span class="n">sfc_6km_shear</span><span class="p">),</span> <span class="n">right_srh1km</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">MS2KTS</span><span class="p">(</span><span class="n">sfc_3km_shear</span><span class="p">),</span> <span class="n">utils</span><span class="o">.</span><span class="n">MS2KTS</span><span class="p">(</span><span class="n">sfc_9km_shear</span><span class="p">),</span> 
                <span class="n">right_srh3km</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_supercell_matches</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_supercell_matches</span> <span class="o">=</span> <span class="n">supercell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">supercell_database</span><span class="p">,</span> <span class="n">mlcape</span><span class="p">,</span> <span class="n">mllcl</span><span class="p">,</span> <span class="n">h500t</span><span class="p">,</span> <span class="n">lapse_rate</span><span class="p">,</span> 
                <span class="n">utils</span><span class="o">.</span><span class="n">MS2KTS</span><span class="p">(</span><span class="n">sfc_6km_shear</span><span class="p">),</span> <span class="o">-</span><span class="n">left_srh1km</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">MS2KTS</span><span class="p">(</span><span class="n">sfc_3km_shear</span><span class="p">),</span> <span class="n">utils</span><span class="o">.</span><span class="n">MS2KTS</span><span class="p">(</span><span class="n">sfc_9km_shear</span><span class="p">),</span> 
                <span class="o">-</span><span class="n">left_srh3km</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_supercell_matches</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">supercell_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_supercell_matches</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_matches</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">supercell_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_supercell_matches</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_matches</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_watch"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_watch">[docs]</a>    <span class="k">def</span> <span class="nf">get_watch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to get the possible watch type.</span>
<span class="sd">        Function returns nothing, but sets the following</span>
<span class="sd">        variables:</span>
<span class="sd">        </span>
<span class="sd">        self.watch_type - possible watch type</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">watch_types</span> <span class="o">=</span> <span class="n">watch_type</span><span class="o">.</span><span class="n">possible_watch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_watch_type</span> <span class="o">=</span> <span class="n">watch_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">watch_types</span> <span class="o">=</span> <span class="n">watch_type</span><span class="o">.</span><span class="n">possible_watch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_watch_type</span> <span class="o">=</span> <span class="n">watch_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">watch_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_watch_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">watch_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_watch_type</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_traj"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_traj">[docs]</a>    <span class="k">def</span> <span class="nf">get_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to compute the storm slinky profile using</span>
<span class="sd">        the trajectory model.</span>

<span class="sd">        self.slinky_traj - the list containing the position vector for the updraft</span>
<span class="sd">        self.updraft_tilt - the updraft tilt (an angle) with respect to the horizon</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
    
        <span class="n">parcel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mupcl</span>
        <span class="n">slinky</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">parcelTraj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parcel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">slinky</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slinky_traj</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updraft_tilt</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slinky_traj</span> <span class="o">=</span> <span class="n">slinky</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updraft_tilt</span> <span class="o">=</span> <span class="n">slinky</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_PWV_loc"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_PWV_loc">[docs]</a>    <span class="k">def</span> <span class="nf">get_PWV_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to compute the location of the current PWV with respect to</span>
<span class="sd">        it&#39;s sounding climatology from Bunkers.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwv_flag</span> <span class="o">=</span> <span class="n">pwv_climo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m&#39;</span><span class="p">)))</span></div>

<div class="viewcode-block" id="ConvectiveProfile.get_indices"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.get_indices">[docs]</a>    <span class="k">def</span> <span class="nf">get_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to set any additional indices that are included in the </span>
<span class="sd">        thermo window.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tei</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">tei</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">esp</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">esp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmp</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mmp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wndg</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">wndg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sig_severe</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sig_severe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpcl_ttrace</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpcl_ptrace</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">dcape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drush</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ctof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dpcl_ttrace</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mburst</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mburst</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConvectiveProfile.set_srleft"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.set_srleft">[docs]</a>    <span class="k">def</span> <span class="nf">set_srleft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lm_u</span><span class="p">,</span> <span class="n">lm_v</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sets the u and v values of the left mover supercell storm motion vector.       </span>
<span class="sd"> </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lm_u : number</span>
<span class="sd">            Left mover u-component of the storm motion vector</span>
<span class="sd">        lm_v : number</span>
<span class="sd">            Left mover v-component of the storm motion vector</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">lm_u</span><span class="p">,</span> <span class="n">lm_v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_kinematics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_severe</span><span class="p">()</span></div>

<div class="viewcode-block" id="ConvectiveProfile.set_srright"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.set_srright">[docs]</a>    <span class="k">def</span> <span class="nf">set_srright</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rm_u</span><span class="p">,</span> <span class="n">rm_v</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sets the u and v values of the right mover supercell storm motion vector.       </span>
<span class="sd"> </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rm_u : number</span>
<span class="sd">            Right mover u-component of the storm motion vector</span>
<span class="sd">        rm_v : number</span>
<span class="sd">            Right mover v-component of the storm motion vector</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="o">=</span> <span class="p">(</span><span class="n">rm_u</span><span class="p">,</span> <span class="n">rm_v</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">get_kinematics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_severe</span><span class="p">()</span></div>

<div class="viewcode-block" id="ConvectiveProfile.reset_srm"><a class="viewcode-back" href="../../../sharppy.sharptab.html#sharppy.sharptab.profile.ConvectiveProfile.reset_srm">[docs]</a>    <span class="k">def</span> <span class="nf">reset_srm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Resets the storm motion vector to those found by the Bunkers algorithm</span>
<span class="sd"> </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_srwind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bunkers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_kinematics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_severe</span><span class="p">()</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Blumberg, W.G, Halbert, K.T., Supinie, T.A., Marsh, P.T., Thompson, R., and J. Hart.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>